module.exports=[46968,a=>{"use strict";a.s(["default",()=>f],46968);var b=a.i(87924),c=a.i(72131),d=a.i(95445);function e({contract:a,onReviewSubmit:e}){let f=(0,d.createClient)(),[g,h]=(0,c.useState)(5),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),o=async b=>{b.preventDefault(),l(!0);try{let{error:b}=await f.from("reviews").insert({contract_id:a.id,instructor_id:a.instructor_id,company_id:a.company_id,rating:g,comment:i});if(b)throw b;e(),n(!1)}catch(a){console.error("Error submitting review:",a),alert(`Failed to submit review: ${a.message}`)}finally{l(!1)}};return m?(0,b.jsxs)("form",{onSubmit:o,className:"p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("h4",{className:"font-bold mb-2",children:"Leave a Review"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{htmlFor:"rating",className:"block text-sm font-medium text-gray-700",children:"Rating (1-5)"}),(0,b.jsx)("input",{type:"number",id:"rating",min:"1",max:"5",value:g,onChange:a=>h(parseInt(a.target.value,10)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{htmlFor:"comment",className:"block text-sm font-medium text-gray-700",children:"Comment"}),(0,b.jsx)("textarea",{id:"comment",rows:3,value:i,onChange:a=>j(a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-sm text-gray-600",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:k,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:"Submit Review"})]})]}):(0,b.jsx)("button",{onClick:()=>n(!0),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Leave a Review"})}function f({contract:a,user:f}){let g=(0,d.createClient)(),[h,i]=(0,c.useState)(a.status),[j,k]=(0,c.useState)(a.reviews[0]?.count>0),[l,m]=(0,c.useState)(!1),n=async()=>{m(!0);try{let{error:b}=await g.from("contracts").update({status:"signed",signed_at:new Date().toISOString()}).eq("id",a.id);if(b)throw b;i("signed")}catch(a){console.error("Error signing contract:",a),alert(`Failed to sign contract: ${a.message}`)}finally{m(!1)}},o=async()=>{m(!0);try{let b=await fetch("/api/checkout_sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractId:a.id})});if(!b.ok)throw Error("Failed to create checkout session.");let{url:c}=await b.json();window.location.href=c}catch(a){console.error("Error redirecting to checkout:",a),alert(`Error: ${a.message}`)}finally{m(!1)}};return f.id===a.instructor_id?"offered"===h?(0,b.jsx)("button",{onClick:n,disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:"Sign Contract"}):(0,b.jsx)("p",{className:`font-semibold capitalize ${"paid"===h?"text-purple-600":"text-gray-600"}`,children:h}):f.id===a.company_id?"signed"===h?(0,b.jsx)("button",{onClick:o,disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-gray-400",children:"Pay Now"}):"paid"!==h||j?(0,b.jsx)("p",{className:`font-semibold capitalize ${"paid"===h?"text-purple-600":"text-gray-600"}`,children:h}):(0,b.jsx)(e,{contract:a,onReviewSubmit:()=>k(!0)}):null}},59789,a=>{a.v(a=>Promise.resolve().then(()=>a(23952)))}];

//# sourceMappingURL=_57771f66._.js.map