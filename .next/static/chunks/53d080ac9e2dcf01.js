(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6085,e=>{"use strict";e.s(["Headers",()=>a,"Request",()=>i,"Response",()=>o,"default",()=>r,"fetch",()=>s]);var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g;let s=t.fetch,r=t.fetch.bind(t),a=t.Headers,i=t.Request,o=t.Response},19414,e=>{"use strict";e.s(["default",()=>i],19414);var t=e.i(43476),s=e.i(71645),r=e.i(11795);function a(e){let{contract:a,onReviewSubmit:i}=e,o=(0,r.createClient)(),[n,d]=(0,s.useState)(5),[c,l]=(0,s.useState)(""),[m,u]=(0,s.useState)(!1),[g,b]=(0,s.useState)(!1),h=async e=>{e.preventDefault(),u(!0);try{let{error:e}=await o.from("reviews").insert({contract_id:a.id,instructor_id:a.instructor_id,company_id:a.company_id,rating:n,comment:c});if(e)throw e;i(),b(!1)}catch(e){console.error("Error submitting review:",e),alert("Failed to submit review: ".concat(e.message))}finally{u(!1)}};return g?(0,t.jsxs)("form",{onSubmit:h,className:"p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-bold mb-2",children:"Leave a Review"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"rating",className:"block text-sm font-medium text-gray-700",children:"Rating (1-5)"}),(0,t.jsx)("input",{type:"number",id:"rating",min:"1",max:"5",value:n,onChange:e=>d(parseInt(e.target.value,10)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"comment",className:"block text-sm font-medium text-gray-700",children:"Comment"}),(0,t.jsx)("textarea",{id:"comment",rows:3,value:c,onChange:e=>l(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 text-sm text-gray-600",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:"Submit Review"})]})]}):(0,t.jsx)("button",{onClick:()=>b(!0),className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Leave a Review"})}function i(e){var i;let{contract:o,user:n}=e,d=(0,r.createClient)(),[c,l]=(0,s.useState)(o.status),[m,u]=(0,s.useState)((null==(i=o.reviews[0])?void 0:i.count)>0),[g,b]=(0,s.useState)(!1),h=async()=>{b(!0);try{let{error:e}=await d.from("contracts").update({status:"signed",signed_at:new Date().toISOString()}).eq("id",o.id);if(e)throw e;l("signed")}catch(e){console.error("Error signing contract:",e),alert("Failed to sign contract: ".concat(e.message))}finally{b(!1)}},p=async()=>{b(!0);try{let e=await fetch("/api/checkout_sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractId:o.id})});if(!e.ok)throw Error("Failed to create checkout session.");let{url:t}=await e.json();window.location.href=t}catch(e){console.error("Error redirecting to checkout:",e),alert("Error: ".concat(e.message))}finally{b(!1)}};return n.id===o.instructor_id?"offered"===c?(0,t.jsx)("button",{onClick:h,disabled:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:"Sign Contract"}):(0,t.jsx)("p",{className:"font-semibold capitalize ".concat("paid"===c?"text-purple-600":"text-gray-600"),children:c}):n.id===o.company_id?"signed"===c?(0,t.jsx)("button",{onClick:p,disabled:g,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-gray-400",children:"Pay Now"}):"paid"!==c||m?(0,t.jsx)("p",{className:"font-semibold capitalize ".concat("paid"===c?"text-purple-600":"text-gray-600"),children:c}):(0,t.jsx)(a,{contract:o,onReviewSubmit:()=>u(!0)}):null}},11737,e=>{e.v(e=>Promise.resolve().then(()=>e(6085)))}]);